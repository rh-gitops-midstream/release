# ------------------------------------------------------------------------------
# Lockfile generation for the Operator container image
# Ref: https://konflux.pages.redhat.com/docs/users/building/prefetching-dependencies.html#enabling-prefetch-builds-for-rpm
#
# Step 1: Copy the default YUM repo configuration from a UBI image:
#   podman run -it registry.redhat.io/ubi9/ubi-minimal cat /etc/yum.repos.d/ubi.repo > ubi.repo
#   sed -i 's/ubi-8-codeready-builder/codeready-builder-for-ubi-8-$basearch/' ubi.repo
#   sed -i 's/\[ubi-8/[ubi-8-for-$basearch/' ubi.repo
#
# Step 2: Generate the lockfile using the rpm-lockfile-prototype tool:
#   rpm-lockfile-prototype \
#     --arch x86_64 --arch aarch64 --arch s390x --arch ppc64le \
#     -f Dockerfile rpms.in.yaml \
#     --outfile rpms.lock.yaml
#
# Alternatively, to run in a container(recommended on macOS/Windows):
#   podman run --rm -v "$PWD:/tmp" quay.io/svghadi/rpm-lockfile-prototype:latest --outfile=/tmp/rpms.lock.yaml /tmp/rpms.in.yaml
#
# For more details, see:
#   - https://github.com/konflux-ci/rpm-lockfile-prototype?tab=readme-ov-file#installation
#   - https://github.com/konflux-ci/rpm-lockfile-prototype/blob/main/README.md#running-in-a-container
# ------------------------------------------------------------------------------
contentOrigin:
  repofiles:
    - ubi.repo
packages:
  - shadow-utils
  - git
  - gpg
  - tar
  - tzdata
  - cmake
  - sed
  - ca-certificates
  - openssl
  - file
  - jq
arches:
  - x86_64
  - aarch64
  - s390x
  - ppc64le
context:
  containerfile:
    file: Dockerfile